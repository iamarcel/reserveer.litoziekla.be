<form
    #form="ngForm"
    (ngSubmit)="submit(form)"
    class="ui form">
  <md-card>
    <sm-loader [complete]="loading <= 0" text="Laden..." class="inverted"></sm-loader>
    <md-card-title *ngIf="production">
      Reserveren voor {{ production.Name }}
    </md-card-title>
    <md-card-title *ngIf="!production">
      Reserveren voor een productie
    </md-card-title>
    <md-card-subtitle *ngIf="!production">
      Laden...
    </md-card-subtitle>
    <md-card-content *ngIf="production">

      <div class="hero" [innerHTML]="production.Hero_Image__c"></div>

      <div *ngIf="!show">
        <h3 class="mdl-typography--title">Kies een voorstelling</h3>

        <sm-list class="very relaxed divided animated">
          <a sm-item
             [header]="show.Entrance__c"
             (click)="setShow(show)"
             *ngFor="let show of production.ChildCampaigns.records">
            <p class="mdl-typography--caption"  *ngIf="!showIsFull(show)">
              {{ show.MaximumProducts__c - show.NumberOfProducts__c }} vrije plaatsen
            </p>
            <p class="mdl-typography--caption" *ngIf="showIsFull(show)">
              Sorry, volzet!
            </p>
          </a>
        </sm-list>
      </div>

      <div *ngIf="show">
        <p class="mdl-typography--subhead">
          Je bent tickets aan het reserveren voor
          {{ show.Entrance__c }}.
        </p>
        <div *ngIf="!submitted">
          <h3 class="ui dividing header">Jouw gegevens</h3>
          <p>Velden met een * zijn verplicht.</p>
          <div class="field">
            <sm-input type="text"
                      label="Voornaam"
                      placeholder="Voornaam..."
                      name="first-name"
                      ngModel>
            </sm-input>
          </div>
          <div class="field">
            <sm-input type="text"
                      label="Achternaam"
                      placeholder="Achternaam..."
                      name="last-name"
                      required
                      ngModel>
            </sm-input>
          </div>
          <div class="field">
            <sm-input type="email"
                      label="E-mailadres"
                      placeholder="mijn@email.com..."
                      name="email" required
                      ngModel>
            </sm-input>
          </div>
          <div class="field">
            <sm-input type="tel"
                      label="Telefoonnummer"
                      placeholder="Telefoonnummer..."
                      name="phone"
                      ngModel>
            </sm-input>
          </div>

          <div *ngIf="reservation.Tickets">
            <h3 class="ui dividing header">Kies je tickets</h3>
            <sm-list class="very relaxed">
              <div class="item"
                   *ngFor="let ticket of reservation.Tickets">
                <div class="right floated content">
                  <div class="ui input buttons">
                    <div class="ui basic button" (click)="removeTicket(ticket)">
                      <md-icon class="inline-icon">remove_circle_outline</md-icon>
                    </div>
                    <input type="number" [(value)]="ticket.amount" style="width: 4em">
                    <div class="ui basic button" (click)="addTicket(ticket)">
                      <md-icon class="inline-icon">add_circle_outline</md-icon>
                    </div>
                  </div>
                </div>

                <div class="content">
                  <div class="header">
                    {{ ticket.ticketType.Name }} ({{ ticket.ticketType.UnitPrice | currency:"EUR":true }})
                  </div>
                  <div class="description">
                    <p>{{ ticket.ticketType.Product2.Description }}</p>
                  </div>
                </div>
              </div>
            </sm-list>
          </div>

        </div>

        <sm-button type="submit"
                   class="primary"
                   [disabled]="submitting || !form.valid" *ngIf="show && !submitted">
          RESERVEER
        </sm-button>

        <div *ngIf="formErrors.length > 0 && !submitted" class="ui negative message">
          <div class="header">
            Oeps, dat ziet er niet goed uit!
          </div>
          <ul class="list">
            <li *ngFor="let error of formErrors">
              {{ error.message }}
            </li>
          </ul>
        </div>


        <div *ngIf="submitted">
          <h3 class="mdl-typography--display-1">
            <md-icon class="inline-icon mdl-color-text--green-500">check</md-icon>
            Klaar!
          </h3>
          <p class="mdl-typography--subhead">Je zal zo dadelijk een bevestigingsmailtje krijgen.</p>
        </div>


      </div>
    </md-card-content>
  </md-card>
</form>

<md-card *ngIf="sponsors">
  <md-card-title>Met dank aan onze sponsors</md-card-title>
  <md-card-subtitle>Zij maakten deze productie mogelijk!</md-card-subtitle>
  <md-card-content class="sponsors">
    <div *ngFor="let sponsor of sponsors" [innerHTML]="sponsor.Logo__c" class="sponsor"></div>
  </md-card-content>
</md-card>
